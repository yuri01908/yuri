<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ğŸ‡ ã‚¢ãƒªã‚¹ToDo</title>
<style>
  body {
    font-family: sans-serif;
    background: #bfe6ff; /* ã‚¢ãƒªã‚¹ã®æœã®æ°´è‰² */
    padding: 20px;
  }
  h1 { color: #2b4c7e; }

  .page { display: none; }
  .active { display: block; }

  .todo {
    margin: 8px 0;
  }

  input[type="text"] {
    width: 220px;
  }

  .rabbit {
    margin-top: 15px;
    background: white;
    padding: 10px;
    border-left: 5px solid #2b4c7e;
  }

  button {
    margin-top: 10px;
  }

  .story {
    background: white;
    padding: 15px;
  }
</style>
</head>
<body>

<h1>ğŸ‡ ã‚¢ãƒªã‚¹ToDo</h1>

<button onclick="showPage('todo')">ToDo</button>
<button onclick="showPage('story')">ç‰©èª</button>

<!-- ToDoãƒšãƒ¼ã‚¸ -->
<div id="todo" class="page active">
  <h2>ä»Šæ—¥ã®ToDoï¼ˆ5å€‹ï¼‰</h2>
  <div id="todoList"></div>
  <div class="rabbit" id="rabbitMessage">
    ç™½ã†ã•ãã€Œä»Šæ—¥ã¯ä½•ã‚’ã™ã‚‹ã‚“ã ã„ï¼Ÿã€
  </div>
</div>

<!-- ç‰©èªãƒšãƒ¼ã‚¸ -->
<div id="story" class="page">
  <h2>ğŸ“– ä¸æ€è­°ã®å›½ã®ã‚¢ãƒªã‚¹</h2>
  <div class="story" id="storyText"></div>
</div>

<script>
const praises = [
  "ã™ã”ã„ã‚ˆï¼",
  "ãã®èª¿å­ã ï¼",
  "æ€¥ãŒãªã„ã¨ï¼ã§ã‚‚ç«‹æ´¾ã ã‚ˆï¼",
  "å›ãªã‚‰ã§ãã‚‹ã¨æ€ã£ã¦ãŸï¼"
];

const stories = [
  "ã‚¢ãƒªã‚¹ã¯é‡åŸã§çœ ã‚Šã‹ã‘ã¦ã„ã‚‹ã¨ã€ç™½ã†ã•ããŒèµ°ã£ã¦ã„ãã®ã‚’è¦‹ã¾ã—ãŸã€‚",
  "ã†ã•ãç©´ã«è½ã¡ãŸã‚¢ãƒªã‚¹ã¯ã€ä¸æ€è­°ãªä¸–ç•Œã¸ã¨è¿·ã„è¾¼ã¿ã¾ã™ã€‚",
  "ã€Œã“ã“ã¯ã©ã“ï¼Ÿã€ã‚¢ãƒªã‚¹ã¯ä¸æ€è­°ãªæ‰‰ã®å‰ã«ç«‹ã£ã¦ã„ã¾ã—ãŸã€‚",
  "ãƒã‚§ã‚·ãƒ£çŒ«ãŒç¾ã‚Œã¦ã€ã«ã‚„ã‚Šã¨ç¬‘ã„ã¾ã—ãŸã€‚",
  "å¥³ç‹ã®åŸãŒè¦‹ãˆã¦ãã¾ã—ãŸâ€¦ã€‚"
];

const today = new Date().toDateString();
const savedDate = localStorage.getItem("date");

if (today !== savedDate) {
  localStorage.setItem("date", today);
  localStorage.setItem("todos", JSON.stringify(
    Array(5).fill().map(() => ({ text: "", done: false }))
  ));
}

let todos = JSON.parse(localStorage.getItem("todos"));
let progress = Number(localStorage.getItem("progress") || 0);

const todoList = document.getElementById("todoList");
const rabbitMessage = document.getElementById("rabbitMessage");
const storyText = document.getElementById("storyText");

function showPage(id) {
  document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if (id === "story") loadStory();
}

function renderTodos() {
  todoList.innerHTML = "";
  todos.forEach((todo, index) => {
    const div = document.createElement("div");
    div.className = "todo";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.checked = todo.done;

    checkbox.onchange = () => {
      todo.done = checkbox.checked;
      localStorage.setItem("todos", JSON.stringify(todos));
      if (todo.done) {
        rabbitMessage.textContent =
          "ğŸ‡ ç™½ã†ã•ãã€Œ" + praises[Math.floor(Math.random()*praises.length)] + "ã€";
      }
    };

    const input = document.createElement("input");
    input.type = "text";
    input.value = todo.text;
    input.placeholder = "ã‚„ã‚‹ã“ã¨ã‚’æ›¸ã";

    input.oninput = () => {
      todo.text = input.value;
      localStorage.setItem("todos", JSON.stringify(todos));
    };

    div.appendChild(checkbox);
    div.appendChild(input);
    todoList.appendChild(div);
  });
}

function loadStory() {
  const allDone = todos.every(t => t.done && t.text.trim() !== "");
  if (!allDone) {
    storyText.innerHTML = "âš ï¸ ä»Šæ—¥ã®ToDoã‚’ã™ã¹ã¦é”æˆã—ãªã„ã¨ç‰©èªã¯èª­ã‚ã¾ã›ã‚“ã€‚";
    return;
  }

  if (progress < stories.length) {
    storyText.innerHTML = stories[progress];
    localStorage.setItem("progress", progress + 1);
  } else {
    storyText.innerHTML = "ç‰©èªã¯ã“ã“ã§ä¸€æ—¦ãŠã—ã¾ã„ã§ã™ã€‚ã¾ãŸæ˜æ—¥ã­ã€‚";
  }
}

renderTodos();
</script>

</body>
</html>
